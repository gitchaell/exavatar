---
import Layout from '../layouts/Layout.astro'
---

<Layout title='Exavatar'>
	<main class='p-6 max-w-5xl mx-auto'>
		<h1 class='text-3xl font-bold mb-4'>
			Welcome to <span class='text-gradient'>Exavatar</span>
		</h1>

		<p class='mb-6'>Use the avatar API to generate dynamic images.</p>

                <div class='flex flex-col md:flex-row gap-6'>
                        <div class='flex-1 flex items-center justify-center'>
                                <img
                                        id='preview'
                                        class='border rounded w-64 h-64 object-cover'
                                        src='/api/avatar'
                                        alt='Preview'
                                />
                        </div>

                        <div class='flex-1 form space-y-2'>
                                <label class='label'>
                                        <span>Set</span>
                                        <select id='set' class='select'>
                                                <option value='animals'>animals</option>
                                        </select>
                                </label>

                                <label class='label'>
                                        <span>Id</span>
                                        <input id='id' type='text' class='input' value='frog' />
                                </label>

                                <label class='label'>
                                        <span>Size</span>
                                        <input id='size' type='number' min='1' max='1024' value='256' class='input' />
                                </label>

                                <label class='label'>
                                        <span>Format</span>
                                        <select id='format' class='select'>
                                                <option value='png'>png</option>
                                                <option value='jpeg'>jpeg</option>
                                                <option value='webp'>webp</option>
                                        </select>
                                </label>

                                <label class='label'>
                                        <span>Text</span>
                                        <input id='text' type='text' maxlength='2' class='input' />
                                </label>

                                <label class='label'>
                                        <span>Color</span>
                                        <input id='color' type='color' value='#000000' class='input' />
                                </label>
                        </div>
                </div>

		<p class='mt-4 break-words'>
			<code
				id='endpoint'
				class='text-sm'
			></code>
		</p>
	</main>
</Layout>

<script>
	const preview = document.getElementById('preview') as HTMLImageElement
	const endpoint = document.getElementById('endpoint') as HTMLElement
	const inputs = Array.from(
		document.querySelectorAll<HTMLInputElement | HTMLSelectElement>('input, select'),
	)

	function update() {
		const params = new URLSearchParams()

		inputs.forEach((input) => {
			if (input.id && input.value) {
				params.set(input.id, input.value)
			}
		})

		const url = `/api/avatar?${params.toString()}`

		preview.src = url
		endpoint.textContent = url
	}

	inputs.forEach((input) => input.addEventListener('input', update))

	update()
</script>

<style>
	main {
		margin: auto;
		padding: 1.5rem;
		max-width: 60ch;
		text-align: center;
	}
	.text-gradient {
		background-image: var(--accent-gradient);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-size: 400%;
		background-position: 0%;
	}
</style>
