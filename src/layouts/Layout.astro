---
import '../styles/global.css'
import { ViewTransitions } from 'astro:transitions'
import Icon from '../components/Icon.astro'
import GridPattern from '../components/GridPattern.astro'
---

<!doctype html>
<html
	lang='en'
	class='h-full'>
	<head>
		<meta charset='UTF-8' />
		<meta
			name='description'
			content='Dynamic avatar generation API built with Deno and Astro'
		/>
		<meta
			name='viewport'
			content='width=device-width'
		/>
		<link
			rel='icon'
			type='image/svg+xml'
			href='/favicon.svg'
		/>
		<meta
			name='generator'
			content={Astro.generator}
		/>
		<title>Exavatar</title>

		<script is:inline>
			;(() => {
				try {
					const stored = localStorage.getItem('exavatar.themeMode')

					if (stored ? stored === 'dark' : matchMedia('(prefers-color-scheme: dark)').matches) {
						document.documentElement.classList.add('dark')
					}
				} catch (_) {}

				const apply = (dark) => {
					document.documentElement.classList.toggle('dark', dark)

					try {
						localStorage.setItem('exavatar.themeMode', dark ? 'dark' : 'light')
					} catch (_) {}
				}

				document.addEventListener('basecoat:theme', (event) => {
					const mode = event.detail?.mode
					apply(
						mode === 'dark' ? true
						: mode === 'light' ? false
						: !document.documentElement.classList.contains('dark'),
					)
				})
			})()
		</script>

		<ViewTransitions />
	</head>

	<body class='h-full min-h-full overflow-x-hidden overflow-y-auto'>
		<nav class='grid grid-cols-12 grid-rows-2 col-span-full md:grid-rows-1 h-24 md:h-12'>
			<h1
				class='grid-box col-span-7 md:col-span-3 text-2xl font-bold italic place-content-center text-center'>
				Exavatar
			</h1>

			<div
				class='grid-box grid grid-flow-col auto-cols-max col-span-full row-start-2 md:col-span-6 md:row-start-1 md:col-start-4 items-center gap-2 px-1 overflow-x-auto overflow-y-hidden'>
				<a
					href='/'
					class='btn-ghost'
					aria-current='page'>
					Playground
				</a>

				<a
					href='/gallery'
					class='btn-ghost'
					aria-current='page'>
					Gallery
				</a>
			</div>

			<div
				class='grid-box grid grid-flow-col auto-cols-max col-span-5 md:col-span-3 items-center gap-2 px-2 justify-end'>
				<button
					type='button'
					aria-label='Toggle dark mode'
					data-tooltip='Toggle dark mode'
					data-side='left'
					onclick="document.dispatchEvent(new CustomEvent('basecoat:theme'))"
					class='btn-icon-outline size-8'>
					<span class='hidden dark:block'><Icon name='sun' /></span>
					<span class='block dark:hidden'><Icon name='moon' /></span>
				</button>

				<a
					href='https://github.com/gitchaell/exavatar'
					target='_blank'
					aria-label='GitHub Respository'
					data-tooltip='GitHub Repository'
					data-side='left'
					class='btn-icon-outline size-8'>
					<Icon name='github' />
				</a>
			</div>
		</nav>

		<slot />

		<div
			id='toaster'
			class='toaster'>
		</div>

		<GridPattern />
	</body>
</html>

<script
	is:inline
	src='/js/basecoat/all.min.js'
	defer
></script>
